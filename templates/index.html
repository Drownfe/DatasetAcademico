<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ“ PredicciÃ³n AcadÃ©mica â€” Notas y CrÃ©ditos</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=3" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ“ PredicciÃ³n de Nota Final y CrÃ©ditos</h1>
      <p class="sub">RegresiÃ³n + ComparaciÃ³n de Modelos + Visualizaciones sobre datasets grandes</p>
    </header>

    <section class="card">
      <div class="hero">
        <div class="controls">
          <label for="rowsInput">TamaÃ±o del dataset:</label>
          <input id="rowsInput" type="number" min="1000" step="1000" value="10000" />
          <label class="chk"><input id="forceChk" type="checkbox" /> Re-crear dataset</label>
        </div>
        <div class="actions">
          <button id="startBtn" class="btn-primary">â–¶ï¸ Empezar</button>
          <a id="btnCsv" class="btn-ghost" href="#">â¬‡ï¸ Dataset CSV</a>
          <a id="btnJson" class="btn-ghost" href="#">â¬‡ï¸ Resultados JSON</a>
        </div>
      </div>

      <div id="steps" class="steps hidden">
        <div class="step"><div class="dot"></div><div class="label">1) Preparando / generando datasetâ€¦</div></div>
        <div class="step"><div class="dot"></div><div class="label">2) Separando X (entradas) y Y (salidas)â€¦</div></div>
        <div class="step"><div class="dot"></div><div class="label">3) Entrenando modelos (LR, Ridge, Lasso, RF, GB)â€¦</div></div>
        <div class="step"><div class="dot"></div><div class="label">4) K-Fold CV y mÃ©tricasâ€¦</div></div>
        <div class="step"><div class="dot"></div><div class="label">5) Renderizando tablas y grÃ¡ficosâ€¦</div></div>
        <div class="progress"><div class="bar" id="bar"></div></div>
      </div>

      <div id="result" class="result hidden">
        <h2>ğŸ“Š Resumen</h2>
        <div class="grid">
          <div class="box">
            <h3>ğŸ“¦ Dataset</h3>
            <p><b>Filas:</b> <span id="rows">â€“</span></p>
            <p><b>Columnas:</b> <span id="cols">â€“</span></p>
            <p><b>Entradas X:</b> <span id="xcols">â€“</span></p>
            <p><b>Salidas Y:</b> <span id="ycols">â€“</span></p>
            <p style="color:#9fc6ff;margin-top:6px;"><small id="note">â€“</small></p>
          </div>
          <div class="box">
            <h3>ğŸ§­ Baseline (promedio)</h3>
            <div class="coefs">
              <div class="pill">MAE: <span id="baseMae">â€“</span></div>
              <div class="pill">RMSE: <span id="baseRmse">â€“</span></div>
              <div class="pill">MAPE %: <span id="baseMape">â€“</span></div>
              <div class="pill">RÂ²: <span id="baseR2">â€“</span></div>
            </div>
          </div>
        </div>

        <h2>âš–ï¸ ComparaciÃ³n de modelos</h2>
        <div class="table-wrap">
          <table id="modelsTable"><thead></thead><tbody></tbody></table>
        </div>
        <canvas id="chartModels" height="120"></canvas>

        <h2>ğŸ§ª Importancia / Coeficientes (mejor modelo)</h2>
        <canvas id="chartCoefs" height="120"></canvas>

        <h2>ğŸ” Real vs Predicho (mejor modelo)</h2>
        <canvas id="chartScatter" height="120"></canvas>

        <h2>ğŸ“‰ DistribuciÃ³n de residuales</h2>
        <canvas id="chartResiduals" height="120"></canvas>

        <h2>ğŸ§Š Matriz de correlaciÃ³n</h2>
        <div id="heatmap" class="heatmap"></div>

        <h2>ğŸ”¢ Vista previa X / Y</h2>
        <h3>Entradas (X)</h3>
        <div class="table-wrap"><table id="tableX"><thead></thead><tbody></tbody></table></div>
        <h3>Salidas (Y)</h3>
        <div class="table-wrap"><table id="tableY"><thead></thead><tbody></tbody></table></div>

        <div class="done">
          <span class="badge">âœ… Proceso completado</span>
          <p>Se comparan modelos lineales y no lineales; se reportan mÃ©tricas (MAE, RMSE, MAPE, RÂ²), validaciÃ³n cruzada,
            correlaciones y vistas previas de X/Y. Puedes descargar el CSV y los resultados en JSON.</p>
        </div>
      </div>

      <div id="error" class="error hidden"></div>
    </section>

    <footer><p>Hecho con ğŸ’™ Flask + scikit-learn + Chart.js</p></footer>
  </div>

  <script src="{{ url_for('static', filename='app.js') }}?v=3"></script>
</body>
</html>
